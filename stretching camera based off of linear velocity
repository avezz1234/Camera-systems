local rs = game:GetService("RunService")
local plrs = game:GetService("Players")

local plr = plrs.LocalPlayer
local cam = workspace.CurrentCamera

local baseFov = 70
local maxIncrease = 30
local maxVel = 80
local smooth = 0.1

local curFov = baseFov
local lastPos = nil

local function curve(t)
	return 1 - (1 - t) * (1 - t)
end

rs.RenderStepped:Connect(function(dt)
	local char = plr.Character
	if not char then return end
	
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	
	local currentPos = hrp.Position
	
	if lastPos then
		local distance = (currentPos - lastPos).Magnitude
		local speed = distance / dt
		
		local t = math.min(speed / maxVel, 1)
		local curved = curve(t)
		local increase = curved * maxIncrease
		
		local targetFov = baseFov + increase
		curFov = curFov + (targetFov - curFov) * smooth
		
		cam.FieldOfView = curFov
	end
	
	lastPos = currentPos
end)
